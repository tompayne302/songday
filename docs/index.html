<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.361">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Tom Payne &amp; Will Armstrong">
<meta name="dcterms.date" content="2023-11-11">

<title>Song Day 2023 - Song day 2023 prediction model</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Song Day 2023</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./index.html" rel="" target="" aria-current="page">
 <span class="menu-text">Song day predictions</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#award-overall-best-performer" id="toc-award-overall-best-performer" class="nav-link active" data-scroll-target="#award-overall-best-performer"><span class="header-section-number">1</span> Award: Overall best performer</a></li>
  <li><a href="#award-best-performer-on-average" id="toc-award-best-performer-on-average" class="nav-link" data-scroll-target="#award-best-performer-on-average"><span class="header-section-number">2</span> Award: Best performer on average</a></li>
  <li><a href="#award-most-consistent-performer" id="toc-award-most-consistent-performer" class="nav-link" data-scroll-target="#award-most-consistent-performer"><span class="header-section-number">3</span> Award: Most consistent performer</a></li>
  <li><a href="#extract-data-from-spotify" id="toc-extract-data-from-spotify" class="nav-link" data-scroll-target="#extract-data-from-spotify"><span class="header-section-number">4</span> Extract data from Spotify</a></li>
  <li><a href="#design-a-statistical-model" id="toc-design-a-statistical-model" class="nav-link" data-scroll-target="#design-a-statistical-model"><span class="header-section-number">5</span> Design a statistical model</a></li>
  <li><a href="#run-the-predictions" id="toc-run-the-predictions" class="nav-link" data-scroll-target="#run-the-predictions"><span class="header-section-number">6</span> Run the predictions</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Song day 2023 prediction model</h1>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Tom Payne &amp; Will Armstrong </p>
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            The Dawg House
          </p>
      </div>
    </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 11, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<p>At the beginning of the film “The Social Network”, we are made aware that Eduardo Saverin (played by Andrew Garfield) had made $300,000 in one summer by trading oil futures. Mark Zuckerberg (played by Jesse Eisenberg), somewhat tongue-in-cheek, explains to Erica Albright (played by Rooney Mara) that Eduardo was able to do this because “He likes meteorology.” Albright, confused, responds, “You said it was oil futures?” Zuckerberg, triumphant that his (soon to be ex-) girlfriend has walked into his trap, explains: “You can read the weather, you can predict the price of heating oil!”</p>
<p>Like Eduardo, we like making predictions. However, we aren’t smart enough to use them to make money, so instead, we will use them to make Pollard do more shots of fireball (admittedly a relatively straightforward task).</p>
<p>Shout out to Sean for collecting all these data. Unfortunately we only have data from Song Days 2 and 3, but it’s enough to work with.</p>
<p>But before we dive in, we need to give out 4 awards based on cumulative evidence from the last 2 song days.</p>
<section id="award-overall-best-performer" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Award: Overall best performer</h1>
<p>Let’s see who has accumulated the most votes over the 2 years. Devillee, Niko, Dee, Steph, and Braith submitted songs in Song day 2 but not 3. Soony, Bods, Eleanor, Seiya, and Holby submitted songs for Song day 3 but not 2. So, omitted these people.</p>
<p>Below in <a href="#tbl-total-votes">Table&nbsp;1</a> I show the ranked for total cumulative votes.</p>
<div class="cell" data-hash="index_cache/html/tbl-total-votes_22a13bfabc5cab48591bdb379be32016">
<div class="cell-output-display">
<div id="tbl-total-votes" class="anchored">

<div id="uxmzddrocr" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#uxmzddrocr table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#uxmzddrocr thead, #uxmzddrocr tbody, #uxmzddrocr tfoot, #uxmzddrocr tr, #uxmzddrocr td, #uxmzddrocr th {
  border-style: none;
}

#uxmzddrocr p {
  margin: 0;
  padding: 0;
}

#uxmzddrocr .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#uxmzddrocr .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#uxmzddrocr .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#uxmzddrocr .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#uxmzddrocr .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#uxmzddrocr .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#uxmzddrocr .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#uxmzddrocr .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#uxmzddrocr .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#uxmzddrocr .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#uxmzddrocr .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#uxmzddrocr .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#uxmzddrocr .gt_spanner_row {
  border-bottom-style: hidden;
}

#uxmzddrocr .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#uxmzddrocr .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#uxmzddrocr .gt_from_md > :first-child {
  margin-top: 0;
}

#uxmzddrocr .gt_from_md > :last-child {
  margin-bottom: 0;
}

#uxmzddrocr .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#uxmzddrocr .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#uxmzddrocr .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#uxmzddrocr .gt_row_group_first td {
  border-top-width: 2px;
}

#uxmzddrocr .gt_row_group_first th {
  border-top-width: 2px;
}

#uxmzddrocr .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#uxmzddrocr .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#uxmzddrocr .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#uxmzddrocr .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#uxmzddrocr .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#uxmzddrocr .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#uxmzddrocr .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#uxmzddrocr .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#uxmzddrocr .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#uxmzddrocr .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#uxmzddrocr .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#uxmzddrocr .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#uxmzddrocr .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#uxmzddrocr .gt_left {
  text-align: left;
}

#uxmzddrocr .gt_center {
  text-align: center;
}

#uxmzddrocr .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#uxmzddrocr .gt_font_normal {
  font-weight: normal;
}

#uxmzddrocr .gt_font_bold {
  font-weight: bold;
}

#uxmzddrocr .gt_font_italic {
  font-style: italic;
}

#uxmzddrocr .gt_super {
  font-size: 65%;
}

#uxmzddrocr .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#uxmzddrocr .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#uxmzddrocr .gt_indent_1 {
  text-indent: 5px;
}

#uxmzddrocr .gt_indent_2 {
  text-indent: 10px;
}

#uxmzddrocr .gt_indent_3 {
  text-indent: 15px;
}

#uxmzddrocr .gt_indent_4 {
  text-indent: 20px;
}

#uxmzddrocr .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false"><caption>Table&nbsp;1:  <p>Cumulative votes for all songs across Song days 2 and 3, excluding
people who didn’t attend one of those years.</p> </caption>
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id=""></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="font-weight: bold;" scope="col" id="Total votes">Total votes</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="font-weight: bold;" scope="col" id="Rank">Rank</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><th id="stub_1_1" scope="row" class="gt_row gt_center gt_stub">Omar</th>
<td headers="stub_1_1 total_votes" class="gt_row gt_right">539</td>
<td headers="stub_1_1 rank" class="gt_row gt_right">1</td></tr>
    <tr><th id="stub_1_2" scope="row" class="gt_row gt_center gt_stub">Sean</th>
<td headers="stub_1_2 total_votes" class="gt_row gt_right">474</td>
<td headers="stub_1_2 rank" class="gt_row gt_right">2</td></tr>
    <tr><th id="stub_1_3" scope="row" class="gt_row gt_center gt_stub">Bonic</th>
<td headers="stub_1_3 total_votes" class="gt_row gt_right">438</td>
<td headers="stub_1_3 rank" class="gt_row gt_right">3</td></tr>
    <tr><th id="stub_1_4" scope="row" class="gt_row gt_center gt_stub">Lex</th>
<td headers="stub_1_4 total_votes" class="gt_row gt_right">414</td>
<td headers="stub_1_4 rank" class="gt_row gt_right">4</td></tr>
    <tr><th id="stub_1_5" scope="row" class="gt_row gt_center gt_stub">Wilson</th>
<td headers="stub_1_5 total_votes" class="gt_row gt_right">409</td>
<td headers="stub_1_5 rank" class="gt_row gt_right">5</td></tr>
    <tr><th id="stub_1_6" scope="row" class="gt_row gt_center gt_stub">Mitch</th>
<td headers="stub_1_6 total_votes" class="gt_row gt_right">345</td>
<td headers="stub_1_6 rank" class="gt_row gt_right">6</td></tr>
    <tr><th id="stub_1_7" scope="row" class="gt_row gt_center gt_stub">Jonny</th>
<td headers="stub_1_7 total_votes" class="gt_row gt_right">310</td>
<td headers="stub_1_7 rank" class="gt_row gt_right">7</td></tr>
    <tr><th id="stub_1_8" scope="row" class="gt_row gt_center gt_stub">Em</th>
<td headers="stub_1_8 total_votes" class="gt_row gt_right">292</td>
<td headers="stub_1_8 rank" class="gt_row gt_right">8</td></tr>
    <tr><th id="stub_1_9" scope="row" class="gt_row gt_center gt_stub">Michael</th>
<td headers="stub_1_9 total_votes" class="gt_row gt_right">242</td>
<td headers="stub_1_9 rank" class="gt_row gt_right">9</td></tr>
    <tr><th id="stub_1_10" scope="row" class="gt_row gt_center gt_stub">Glen</th>
<td headers="stub_1_10 total_votes" class="gt_row gt_right">235</td>
<td headers="stub_1_10 rank" class="gt_row gt_right">10</td></tr>
    <tr><th id="stub_1_11" scope="row" class="gt_row gt_center gt_stub">Veronica</th>
<td headers="stub_1_11 total_votes" class="gt_row gt_right">230</td>
<td headers="stub_1_11 rank" class="gt_row gt_right">11</td></tr>
    <tr><th id="stub_1_12" scope="row" class="gt_row gt_center gt_stub">Tish</th>
<td headers="stub_1_12 total_votes" class="gt_row gt_right">227</td>
<td headers="stub_1_12 rank" class="gt_row gt_right">12</td></tr>
    <tr><th id="stub_1_13" scope="row" class="gt_row gt_center gt_stub">Erana</th>
<td headers="stub_1_13 total_votes" class="gt_row gt_right">219</td>
<td headers="stub_1_13 rank" class="gt_row gt_right">13</td></tr>
    <tr><th id="stub_1_14" scope="row" class="gt_row gt_center gt_stub">Anna</th>
<td headers="stub_1_14 total_votes" class="gt_row gt_right">214</td>
<td headers="stub_1_14 rank" class="gt_row gt_right">14</td></tr>
    <tr><th id="stub_1_15" scope="row" class="gt_row gt_center gt_stub">Pollard</th>
<td headers="stub_1_15 total_votes" class="gt_row gt_right">199</td>
<td headers="stub_1_15 rank" class="gt_row gt_right">15</td></tr>
    <tr><th id="stub_1_16" scope="row" class="gt_row gt_center gt_stub">Oli</th>
<td headers="stub_1_16 total_votes" class="gt_row gt_right">193</td>
<td headers="stub_1_16 rank" class="gt_row gt_right">16</td></tr>
    <tr><th id="stub_1_17" scope="row" class="gt_row gt_center gt_stub">Claudia</th>
<td headers="stub_1_17 total_votes" class="gt_row gt_right">188</td>
<td headers="stub_1_17 rank" class="gt_row gt_right">17</td></tr>
    <tr><th id="stub_1_18" scope="row" class="gt_row gt_center gt_stub">Tom Payne</th>
<td headers="stub_1_18 total_votes" class="gt_row gt_right">184</td>
<td headers="stub_1_18 rank" class="gt_row gt_right">18</td></tr>
    <tr><th id="stub_1_19" scope="row" class="gt_row gt_center gt_stub">Josh</th>
<td headers="stub_1_19 total_votes" class="gt_row gt_right">178</td>
<td headers="stub_1_19 rank" class="gt_row gt_right">19</td></tr>
    <tr><th id="stub_1_20" scope="row" class="gt_row gt_center gt_stub">Anushka</th>
<td headers="stub_1_20 total_votes" class="gt_row gt_right">167</td>
<td headers="stub_1_20 rank" class="gt_row gt_right">20</td></tr>
    <tr><th id="stub_1_21" scope="row" class="gt_row gt_center gt_stub">Bibby</th>
<td headers="stub_1_21 total_votes" class="gt_row gt_right">134</td>
<td headers="stub_1_21 rank" class="gt_row gt_right">21</td></tr>
    <tr><th id="stub_1_22" scope="row" class="gt_row gt_center gt_stub">Liam</th>
<td headers="stub_1_22 total_votes" class="gt_row gt_right">109</td>
<td headers="stub_1_22 rank" class="gt_row gt_right">22</td></tr>
    <tr><th id="stub_1_23" scope="row" class="gt_row gt_center gt_stub">Zhang</th>
<td headers="stub_1_23 total_votes" class="gt_row gt_right">76</td>
<td headers="stub_1_23 rank" class="gt_row gt_right">23</td></tr>
    <tr><th id="stub_1_24" scope="row" class="gt_row gt_center gt_stub">Warmy</th>
<td headers="stub_1_24 total_votes" class="gt_row gt_right">36</td>
<td headers="stub_1_24 rank" class="gt_row gt_right">24</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</div>
</section>
<section id="award-best-performer-on-average" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Award: Best performer on average</h1>
<p>But that’s not the whole story, is it. We’re not just interested in the <em>total</em> number of votes someone got, we’re interested also in the <em>average</em> votes. Because the mean will be a highly skewed metric in our data, let’s use the <em>median</em> (middle) number of votes.</p>
<div class="cell" data-hash="index_cache/html/tbl-medial-votes_3d7038b00219b6f231c28d537d8280b7">
<div class="cell-output-display">
<div id="tbl-medial-votes" class="anchored">

<div id="nsuhueevon" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#nsuhueevon table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#nsuhueevon thead, #nsuhueevon tbody, #nsuhueevon tfoot, #nsuhueevon tr, #nsuhueevon td, #nsuhueevon th {
  border-style: none;
}

#nsuhueevon p {
  margin: 0;
  padding: 0;
}

#nsuhueevon .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#nsuhueevon .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#nsuhueevon .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#nsuhueevon .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#nsuhueevon .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#nsuhueevon .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nsuhueevon .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#nsuhueevon .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#nsuhueevon .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#nsuhueevon .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#nsuhueevon .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#nsuhueevon .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#nsuhueevon .gt_spanner_row {
  border-bottom-style: hidden;
}

#nsuhueevon .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#nsuhueevon .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#nsuhueevon .gt_from_md > :first-child {
  margin-top: 0;
}

#nsuhueevon .gt_from_md > :last-child {
  margin-bottom: 0;
}

#nsuhueevon .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#nsuhueevon .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#nsuhueevon .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#nsuhueevon .gt_row_group_first td {
  border-top-width: 2px;
}

#nsuhueevon .gt_row_group_first th {
  border-top-width: 2px;
}

#nsuhueevon .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#nsuhueevon .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#nsuhueevon .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#nsuhueevon .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nsuhueevon .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#nsuhueevon .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#nsuhueevon .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#nsuhueevon .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#nsuhueevon .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nsuhueevon .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#nsuhueevon .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#nsuhueevon .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#nsuhueevon .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#nsuhueevon .gt_left {
  text-align: left;
}

#nsuhueevon .gt_center {
  text-align: center;
}

#nsuhueevon .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#nsuhueevon .gt_font_normal {
  font-weight: normal;
}

#nsuhueevon .gt_font_bold {
  font-weight: bold;
}

#nsuhueevon .gt_font_italic {
  font-style: italic;
}

#nsuhueevon .gt_super {
  font-size: 65%;
}

#nsuhueevon .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#nsuhueevon .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#nsuhueevon .gt_indent_1 {
  text-indent: 5px;
}

#nsuhueevon .gt_indent_2 {
  text-indent: 10px;
}

#nsuhueevon .gt_indent_3 {
  text-indent: 15px;
}

#nsuhueevon .gt_indent_4 {
  text-indent: 20px;
}

#nsuhueevon .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false"><caption>Table&nbsp;2:  <p>Median votes for each song across Song days 2 and 3, excluding people
who didn’t attend one of those years.</p> </caption>
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id=""></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="font-weight: bold;" scope="col" id="Median number of votes">Median number of votes</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="font-weight: bold;" scope="col" id="Rank">Rank</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><th id="stub_1_1" scope="row" class="gt_row gt_center gt_stub">Sean</th>
<td headers="stub_1_1 avg_votes" class="gt_row gt_right">20.0</td>
<td headers="stub_1_1 rank" class="gt_row gt_right">1.0</td></tr>
    <tr><th id="stub_1_2" scope="row" class="gt_row gt_center gt_stub">Lex</th>
<td headers="stub_1_2 avg_votes" class="gt_row gt_right">17.5</td>
<td headers="stub_1_2 rank" class="gt_row gt_right">2.5</td></tr>
    <tr><th id="stub_1_3" scope="row" class="gt_row gt_center gt_stub">Wilson</th>
<td headers="stub_1_3 avg_votes" class="gt_row gt_right">17.5</td>
<td headers="stub_1_3 rank" class="gt_row gt_right">2.5</td></tr>
    <tr><th id="stub_1_4" scope="row" class="gt_row gt_center gt_stub">Bonic</th>
<td headers="stub_1_4 avg_votes" class="gt_row gt_right">14.0</td>
<td headers="stub_1_4 rank" class="gt_row gt_right">5.0</td></tr>
    <tr><th id="stub_1_5" scope="row" class="gt_row gt_center gt_stub">Em</th>
<td headers="stub_1_5 avg_votes" class="gt_row gt_right">14.0</td>
<td headers="stub_1_5 rank" class="gt_row gt_right">5.0</td></tr>
    <tr><th id="stub_1_6" scope="row" class="gt_row gt_center gt_stub">Michael</th>
<td headers="stub_1_6 avg_votes" class="gt_row gt_right">14.0</td>
<td headers="stub_1_6 rank" class="gt_row gt_right">5.0</td></tr>
    <tr><th id="stub_1_7" scope="row" class="gt_row gt_center gt_stub">Mitch</th>
<td headers="stub_1_7 avg_votes" class="gt_row gt_right">13.5</td>
<td headers="stub_1_7 rank" class="gt_row gt_right">7.0</td></tr>
    <tr><th id="stub_1_8" scope="row" class="gt_row gt_center gt_stub">Jonny</th>
<td headers="stub_1_8 avg_votes" class="gt_row gt_right">11.5</td>
<td headers="stub_1_8 rank" class="gt_row gt_right">8.0</td></tr>
    <tr><th id="stub_1_9" scope="row" class="gt_row gt_center gt_stub">Anna</th>
<td headers="stub_1_9 avg_votes" class="gt_row gt_right">11.0</td>
<td headers="stub_1_9 rank" class="gt_row gt_right">9.0</td></tr>
    <tr><th id="stub_1_10" scope="row" class="gt_row gt_center gt_stub">Tish</th>
<td headers="stub_1_10 avg_votes" class="gt_row gt_right">8.5</td>
<td headers="stub_1_10 rank" class="gt_row gt_right">10.0</td></tr>
    <tr><th id="stub_1_11" scope="row" class="gt_row gt_center gt_stub">Erana</th>
<td headers="stub_1_11 avg_votes" class="gt_row gt_right">8.0</td>
<td headers="stub_1_11 rank" class="gt_row gt_right">11.5</td></tr>
    <tr><th id="stub_1_12" scope="row" class="gt_row gt_center gt_stub">Omar</th>
<td headers="stub_1_12 avg_votes" class="gt_row gt_right">8.0</td>
<td headers="stub_1_12 rank" class="gt_row gt_right">11.5</td></tr>
    <tr><th id="stub_1_13" scope="row" class="gt_row gt_center gt_stub">Claudia</th>
<td headers="stub_1_13 avg_votes" class="gt_row gt_right">6.0</td>
<td headers="stub_1_13 rank" class="gt_row gt_right">13.5</td></tr>
    <tr><th id="stub_1_14" scope="row" class="gt_row gt_center gt_stub">Josh</th>
<td headers="stub_1_14 avg_votes" class="gt_row gt_right">6.0</td>
<td headers="stub_1_14 rank" class="gt_row gt_right">13.5</td></tr>
    <tr><th id="stub_1_15" scope="row" class="gt_row gt_center gt_stub">Oli</th>
<td headers="stub_1_15 avg_votes" class="gt_row gt_right">4.0</td>
<td headers="stub_1_15 rank" class="gt_row gt_right">15.0</td></tr>
    <tr><th id="stub_1_16" scope="row" class="gt_row gt_center gt_stub">Bibby</th>
<td headers="stub_1_16 avg_votes" class="gt_row gt_right">3.5</td>
<td headers="stub_1_16 rank" class="gt_row gt_right">16.0</td></tr>
    <tr><th id="stub_1_17" scope="row" class="gt_row gt_center gt_stub">Pollard</th>
<td headers="stub_1_17 avg_votes" class="gt_row gt_right">2.0</td>
<td headers="stub_1_17 rank" class="gt_row gt_right">17.5</td></tr>
    <tr><th id="stub_1_18" scope="row" class="gt_row gt_center gt_stub">Veronica</th>
<td headers="stub_1_18 avg_votes" class="gt_row gt_right">2.0</td>
<td headers="stub_1_18 rank" class="gt_row gt_right">17.5</td></tr>
    <tr><th id="stub_1_19" scope="row" class="gt_row gt_center gt_stub">Tom Payne</th>
<td headers="stub_1_19 avg_votes" class="gt_row gt_right">1.5</td>
<td headers="stub_1_19 rank" class="gt_row gt_right">19.0</td></tr>
    <tr><th id="stub_1_20" scope="row" class="gt_row gt_center gt_stub">Glen</th>
<td headers="stub_1_20 avg_votes" class="gt_row gt_right">1.0</td>
<td headers="stub_1_20 rank" class="gt_row gt_right">20.0</td></tr>
    <tr><th id="stub_1_21" scope="row" class="gt_row gt_center gt_stub">Anushka</th>
<td headers="stub_1_21 avg_votes" class="gt_row gt_right">0.0</td>
<td headers="stub_1_21 rank" class="gt_row gt_right">22.5</td></tr>
    <tr><th id="stub_1_22" scope="row" class="gt_row gt_center gt_stub">Liam</th>
<td headers="stub_1_22 avg_votes" class="gt_row gt_right">0.0</td>
<td headers="stub_1_22 rank" class="gt_row gt_right">22.5</td></tr>
    <tr><th id="stub_1_23" scope="row" class="gt_row gt_center gt_stub">Warmy</th>
<td headers="stub_1_23 avg_votes" class="gt_row gt_right">0.0</td>
<td headers="stub_1_23 rank" class="gt_row gt_right">22.5</td></tr>
    <tr><th id="stub_1_24" scope="row" class="gt_row gt_center gt_stub">Zhang</th>
<td headers="stub_1_24 avg_votes" class="gt_row gt_right">0.0</td>
<td headers="stub_1_24 rank" class="gt_row gt_right">22.5</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</div>
</section>
<section id="award-most-consistent-performer" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Award: Most consistent performer</h1>
<p>And the most consistent performer, indicated by the percentage of songs which got &gt;0 votes in <a href="#tbl-consistent-votes">Table&nbsp;3</a>:</p>
<div class="cell" data-hash="index_cache/html/tbl-consistent-votes_777467c84bffb3e3e30f92eb5c08a6db">
<div class="cell-output-display">
<div id="tbl-consistent-votes" class="anchored">

<div id="plrzprvpxm" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#plrzprvpxm table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#plrzprvpxm thead, #plrzprvpxm tbody, #plrzprvpxm tfoot, #plrzprvpxm tr, #plrzprvpxm td, #plrzprvpxm th {
  border-style: none;
}

#plrzprvpxm p {
  margin: 0;
  padding: 0;
}

#plrzprvpxm .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#plrzprvpxm .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#plrzprvpxm .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#plrzprvpxm .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#plrzprvpxm .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#plrzprvpxm .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#plrzprvpxm .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#plrzprvpxm .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#plrzprvpxm .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#plrzprvpxm .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#plrzprvpxm .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#plrzprvpxm .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#plrzprvpxm .gt_spanner_row {
  border-bottom-style: hidden;
}

#plrzprvpxm .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#plrzprvpxm .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#plrzprvpxm .gt_from_md > :first-child {
  margin-top: 0;
}

#plrzprvpxm .gt_from_md > :last-child {
  margin-bottom: 0;
}

#plrzprvpxm .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#plrzprvpxm .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#plrzprvpxm .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#plrzprvpxm .gt_row_group_first td {
  border-top-width: 2px;
}

#plrzprvpxm .gt_row_group_first th {
  border-top-width: 2px;
}

#plrzprvpxm .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#plrzprvpxm .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#plrzprvpxm .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#plrzprvpxm .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#plrzprvpxm .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#plrzprvpxm .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#plrzprvpxm .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#plrzprvpxm .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#plrzprvpxm .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#plrzprvpxm .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#plrzprvpxm .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#plrzprvpxm .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#plrzprvpxm .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#plrzprvpxm .gt_left {
  text-align: left;
}

#plrzprvpxm .gt_center {
  text-align: center;
}

#plrzprvpxm .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#plrzprvpxm .gt_font_normal {
  font-weight: normal;
}

#plrzprvpxm .gt_font_bold {
  font-weight: bold;
}

#plrzprvpxm .gt_font_italic {
  font-style: italic;
}

#plrzprvpxm .gt_super {
  font-size: 65%;
}

#plrzprvpxm .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#plrzprvpxm .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#plrzprvpxm .gt_indent_1 {
  text-indent: 5px;
}

#plrzprvpxm .gt_indent_2 {
  text-indent: 10px;
}

#plrzprvpxm .gt_indent_3 {
  text-indent: 15px;
}

#plrzprvpxm .gt_indent_4 {
  text-indent: 20px;
}

#plrzprvpxm .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false"><caption>Table&nbsp;3:  <p>Percentage of songs with more than 0 votes across Song days 2 and 3,
excluding people who didn’t attend one of those years.</p> </caption>
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id=""></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="font-weight: bold;" scope="col" id="% of songs of 0 votes">% of songs of 0 votes</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="font-weight: bold;" scope="col" id="Rank">Rank</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><th id="stub_1_1" scope="row" class="gt_row gt_center gt_stub">Sean</th>
<td headers="stub_1_1 zero_votes_percent" class="gt_row gt_right">0</td>
<td headers="stub_1_1 rank" class="gt_row gt_right">1.0</td></tr>
    <tr><th id="stub_1_2" scope="row" class="gt_row gt_center gt_stub">Wilson</th>
<td headers="stub_1_2 zero_votes_percent" class="gt_row gt_right">5</td>
<td headers="stub_1_2 rank" class="gt_row gt_right">2.0</td></tr>
    <tr><th id="stub_1_3" scope="row" class="gt_row gt_center gt_stub">Bonic</th>
<td headers="stub_1_3 zero_votes_percent" class="gt_row gt_right">10</td>
<td headers="stub_1_3 rank" class="gt_row gt_right">3.5</td></tr>
    <tr><th id="stub_1_4" scope="row" class="gt_row gt_center gt_stub">Lex</th>
<td headers="stub_1_4 zero_votes_percent" class="gt_row gt_right">10</td>
<td headers="stub_1_4 rank" class="gt_row gt_right">3.5</td></tr>
    <tr><th id="stub_1_5" scope="row" class="gt_row gt_center gt_stub">Mitch</th>
<td headers="stub_1_5 zero_votes_percent" class="gt_row gt_right">15</td>
<td headers="stub_1_5 rank" class="gt_row gt_right">5.0</td></tr>
    <tr><th id="stub_1_6" scope="row" class="gt_row gt_center gt_stub">Anna</th>
<td headers="stub_1_6 zero_votes_percent" class="gt_row gt_right">19</td>
<td headers="stub_1_6 rank" class="gt_row gt_right">6.0</td></tr>
    <tr><th id="stub_1_7" scope="row" class="gt_row gt_center gt_stub">Em</th>
<td headers="stub_1_7 zero_votes_percent" class="gt_row gt_right">20</td>
<td headers="stub_1_7 rank" class="gt_row gt_right">7.5</td></tr>
    <tr><th id="stub_1_8" scope="row" class="gt_row gt_center gt_stub">Tish</th>
<td headers="stub_1_8 zero_votes_percent" class="gt_row gt_right">20</td>
<td headers="stub_1_8 rank" class="gt_row gt_right">7.5</td></tr>
    <tr><th id="stub_1_9" scope="row" class="gt_row gt_center gt_stub">Erana</th>
<td headers="stub_1_9 zero_votes_percent" class="gt_row gt_right">21</td>
<td headers="stub_1_9 rank" class="gt_row gt_right">9.0</td></tr>
    <tr><th id="stub_1_10" scope="row" class="gt_row gt_center gt_stub">Josh</th>
<td headers="stub_1_10 zero_votes_percent" class="gt_row gt_right">26</td>
<td headers="stub_1_10 rank" class="gt_row gt_right">10.0</td></tr>
    <tr><th id="stub_1_11" scope="row" class="gt_row gt_center gt_stub">Omar</th>
<td headers="stub_1_11 zero_votes_percent" class="gt_row gt_right">30</td>
<td headers="stub_1_11 rank" class="gt_row gt_right">11.0</td></tr>
    <tr><th id="stub_1_12" scope="row" class="gt_row gt_center gt_stub">Claudia</th>
<td headers="stub_1_12 zero_votes_percent" class="gt_row gt_right">35</td>
<td headers="stub_1_12 rank" class="gt_row gt_right">12.5</td></tr>
    <tr><th id="stub_1_13" scope="row" class="gt_row gt_center gt_stub">Jonny</th>
<td headers="stub_1_13 zero_votes_percent" class="gt_row gt_right">35</td>
<td headers="stub_1_13 rank" class="gt_row gt_right">12.5</td></tr>
    <tr><th id="stub_1_14" scope="row" class="gt_row gt_center gt_stub">Bibby</th>
<td headers="stub_1_14 zero_votes_percent" class="gt_row gt_right">40</td>
<td headers="stub_1_14 rank" class="gt_row gt_right">15.5</td></tr>
    <tr><th id="stub_1_15" scope="row" class="gt_row gt_center gt_stub">Michael</th>
<td headers="stub_1_15 zero_votes_percent" class="gt_row gt_right">40</td>
<td headers="stub_1_15 rank" class="gt_row gt_right">15.5</td></tr>
    <tr><th id="stub_1_16" scope="row" class="gt_row gt_center gt_stub">Oli</th>
<td headers="stub_1_16 zero_votes_percent" class="gt_row gt_right">40</td>
<td headers="stub_1_16 rank" class="gt_row gt_right">15.5</td></tr>
    <tr><th id="stub_1_17" scope="row" class="gt_row gt_center gt_stub">Veronica</th>
<td headers="stub_1_17 zero_votes_percent" class="gt_row gt_right">40</td>
<td headers="stub_1_17 rank" class="gt_row gt_right">15.5</td></tr>
    <tr><th id="stub_1_18" scope="row" class="gt_row gt_center gt_stub">Glen</th>
<td headers="stub_1_18 zero_votes_percent" class="gt_row gt_right">43</td>
<td headers="stub_1_18 rank" class="gt_row gt_right">18.0</td></tr>
    <tr><th id="stub_1_19" scope="row" class="gt_row gt_center gt_stub">Pollard</th>
<td headers="stub_1_19 zero_votes_percent" class="gt_row gt_right">45</td>
<td headers="stub_1_19 rank" class="gt_row gt_right">19.0</td></tr>
    <tr><th id="stub_1_20" scope="row" class="gt_row gt_center gt_stub">Tom Payne</th>
<td headers="stub_1_20 zero_votes_percent" class="gt_row gt_right">50</td>
<td headers="stub_1_20 rank" class="gt_row gt_right">20.0</td></tr>
    <tr><th id="stub_1_21" scope="row" class="gt_row gt_center gt_stub">Anushka</th>
<td headers="stub_1_21 zero_votes_percent" class="gt_row gt_right">60</td>
<td headers="stub_1_21 rank" class="gt_row gt_right">21.5</td></tr>
    <tr><th id="stub_1_22" scope="row" class="gt_row gt_center gt_stub">Liam</th>
<td headers="stub_1_22 zero_votes_percent" class="gt_row gt_right">60</td>
<td headers="stub_1_22 rank" class="gt_row gt_right">21.5</td></tr>
    <tr><th id="stub_1_23" scope="row" class="gt_row gt_center gt_stub">Zhang</th>
<td headers="stub_1_23 zero_votes_percent" class="gt_row gt_right">74</td>
<td headers="stub_1_23 rank" class="gt_row gt_right">23.0</td></tr>
    <tr><th id="stub_1_24" scope="row" class="gt_row gt_center gt_stub">Warmy</th>
<td headers="stub_1_24 zero_votes_percent" class="gt_row gt_right">80</td>
<td headers="stub_1_24 rank" class="gt_row gt_right">24.0</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</div>
<p>Now to the predictions!</p>
<p>This is going to get very stats-heavy very quickly. If you don’t usually get a insatiable thirst for statistics arguments after 1.5 beers then it’s probably not worth reading on.</p>
<p>That being said, originally we had planned to experiment with various types of machine learning to create the ‘optimal’ prediction model based on our data, but alas we overestimated the amount of free time we would have to invest in this.</p>
<p>So, we will just thrust all our available variables into a (hopefully well-fitting) statistical model, and then use it to predict the votes for the 2023 songs. Essentially we are hitting a complex, nuanced, precise statistical question on the head with a sledgehammer.</p>
<p>Our approach has 3 components:</p>
<ol type="1">
<li>Extract all of the available data from Spotify for all of the songs from previous Song days, and combine this with the number of votes each song received.</li>
<li>Design a statistical model that best fits the data we have obtained from Spotify.</li>
<li>Pass the 2023 Song day data to the model, and make predictions about the number of votes each song will get.</li>
</ol>
</section>
<section id="extract-data-from-spotify" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Extract data from Spotify</h1>
<p>The approach we used here has been well-described elsewhere, for example, <a href="https://martijnvanvreeden.nl/collecting-spotify-data-with-r/">here</a> and <a href="https://mcmullarkey.github.io/mcm-blog/posts/2022-01-07-spotify-api-r/">here</a>.</p>
<p>The available metrics of interest to us that you can extract from Spotify are: popularity, acousticness, danceability, energy, instrumentalness, liveness, loudness, speechiness, tempo, valence, and key.</p>
<p>Now what we are interested in is using a combination of these parameters to estimate the number of votes each song got.</p>
</section>
<section id="design-a-statistical-model" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Design a statistical model</h1>
<p>So, our outcome of interest is vote count. This is our ‘response’ or ‘dependent’ or ‘outcome’ variable (all synonyms).</p>
<p>First let’s start by looking at how the votes have been distributed across songs over the years. As you can see, most songs get 0 votes.</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-4_31443e0b041ec61651f5b752707b0726">
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" style="width:90.0%"></p>
</div>
</div>
<p>Now we need to find a statistical model that will fit this distribution. It’s hugely skewed count data, and has lots of 0’s, so traditional stuff won’t work.</p>
<p>When we talk about ‘count data’ - you generally have two options: A Poisson-family model or negative binomial-family model, which essentially just differ by the estimation of a dispersion parameter in the negative binomial model. Both of these models can be zero-inflated if you need (to account for excess 0’s).</p>
<p>We’ll include all the covariables we have available and also an offset term for the year in which the vote was cast (as the max number of votes in 2021 was 10 whereas in 2022 it was 15). We’ll use the default priors in <code>brms</code> which is super bad practice but I CBF to think about this.</p>
<p>We are going to use a Bayesian approach, because it’s cooler and we are nothing if not really cool. We will use the <code>brms</code> package for regression. So, this is what our statistical model looks like in R (I’ve given the family as <code>poisson</code> but we will change this):</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> raw_votes <span class="sc">~</span> popularity <span class="sc">+</span> acousticness <span class="sc">+</span> danceability <span class="sc">+</span> energy <span class="sc">+</span> instrumentalness <span class="sc">+</span> </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>                       liveness <span class="sc">+</span> loudness <span class="sc">+</span> speechiness <span class="sc">+</span> tempo <span class="sc">+</span> valence <span class="sc">+</span> key <span class="sc">+</span> duration <span class="sc">+</span> <span class="fu">offset</span>(<span class="fu">log</span>(year))</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> brms<span class="sc">::</span><span class="fu">brm</span>(formula, </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> data, <span class="at">family =</span> <span class="fu">poisson</span>(),</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">iter =</span> <span class="dv">4000</span>,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">backend =</span> <span class="st">"cmdstanr"</span>, </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">cores =</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>(),</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">seed =</span> <span class="dv">123</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>I’m going to start off with a zero-inflated negative binomial model because that’s the vibe I’m getting, but we will confirm this is the right choice.</p>
<p>In a Bayesian context, we can use leave-one-out cross validation (LOO) to compare the fit of statistical models - see <a href="https://bookdown.org/ajkurz/DBDA_recoded/model-comparison-and-hierarchical-modeling.html">this link</a> for guidance.</p>
<p>Let’s start by comparing a zero-inflated negative binomial model to a zero-inflated Poisson model. This method compares the LOO value for each model, and the better model is placed on top by default.</p>
<p>As shown below, the negative binomial provides a MUCH better fit.</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-5_f746c07a5ca37f4a9d2757010d47c826">
<div class="cell-output cell-output-stdout">
<pre><code>             elpd_diff se_diff
zi_neg_binom     0.0       0.0
zi_poisson   -1419.8     155.7</code></pre>
</div>
</div>
<p>But is the zero-inflated component needed? Let’s check.</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-6_ac3e21677cc6cfe5229d2d31a929abbe">
<div class="cell-output cell-output-stdout">
<pre><code>            elpd_diff se_diff
zi_negbinom   0.0       0.0  
negbinom    -74.4      11.2  </code></pre>
</div>
</div>
<p>This suggests the zero-inflated model provides a much better fit.</p>
<p>Let’s use another method to check that the zero-inflation is better. This method also compares model fit, using the LOO to assign weights. These are (heuristic) probabilities, with the values being the relative ‘weights’ we should assign to each model.</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-7_0d6df262f6a50dd157d94eaa5919c532">
<div class="cell-output cell-output-stdout">
<pre><code>zi_negbinom    negbinom 
 0.94895148  0.05104852 </code></pre>
</div>
</div>
<p>Consistent with the previous analysis, this suggests the zero-inflated model provides a much better fit suggesting we should assign 19x more weight to it. So we’ll go with that one.</p>
<p>However, there are actually two ways of modelling excess zero-count data using the negative binomial distribution. We have used a zero-inflated or a hurdle negative binomial model. A description of the difference is <a href="https://stats.stackexchange.com/questions/81457/what-is-the-difference-between-zero-inflated-and-hurdle-models">here</a>. Let’s see if there’s much of a difference in the fit of the models.</p>
<p>The answer is: not really, but the zero-inflated model is probably slightly better.</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-8_e422089f65f622eceb0748669bfaa7ac">
<div class="cell-output cell-output-stdout">
<pre><code>                elpd_diff se_diff
zi_negbinom      0.0       0.0   
hurdle_negbinom -0.2       0.6   </code></pre>
</div>
</div>
<p>Now, using the DHARMa package, let’s look for evidence of nonlinearity in our data. Guidance on what this package does is <a href="https://cran.r-project.org/web/packages/DHARMa/vignettes/DHARMa.html">here</a>.</p>
<p>From the plots in <a href="#fig-dharma">Figure&nbsp;1</a>, there are no issues with overdisperson/nonlinearity.</p>
<div class="cell" data-hash="index_cache/html/fig-dharma_117bc4f7371c305a1e0851f5a8618e10">
<div class="cell-output-display">
<div id="fig-dharma" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-dharma-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;1: Plots of simulated residuals from the DHARMa package in R.</figcaption>
</figure>
</div>
</div>
</div>
<p>Now let’s actually have a look at the plots of the coefficients in <a href="#fig-coefs">Figure&nbsp;2</a>. Do any of these metrics actually individually predict the number of votes a song got?</p>
<p>Answer: not really.</p>
<div class="cell" data-hash="index_cache/html/fig-coefs_a8511dc17be1619e47305ff587196860">
<div class="cell-output-display">
<div id="fig-coefs" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-coefs-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;2: Plots of the posteriors of the Bayesian model coefficients.</figcaption>
</figure>
</div>
</div>
</div>
<p>Let’s see how much of the variability in vote count is explained by our model. We’ll using the Bayesian version of <span class="math inline">\(R^2\)</span>:</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-11_d7bfee9c0a97d7676a7514ff4dfccff0">
<div class="cell-output cell-output-stdout">
<pre><code>     Estimate  Est.Error       Q2.5     Q97.5
R2 0.06735732 0.01618531 0.04092909 0.1037255</code></pre>
</div>
</div>
<p>So it explains 6% of the variability. That’s a horrifically performing model.</p>
<p>Alas, let’s press on.</p>
</section>
<section id="run-the-predictions" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Run the predictions</h1>
<p>Now for the fun! We’ll use the <code>marginaleffects</code> package to calculate the predicted vote count for each of the new songs, based on their values for all the variables in the model. Below, as a teaser, I will provide the songs which ranked 40-50:</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-12_eb75780d513a1b7af68520af871f8fa9">
<div class="cell-output-display">

<div id="vgzjjfmrhz" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#vgzjjfmrhz table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#vgzjjfmrhz thead, #vgzjjfmrhz tbody, #vgzjjfmrhz tfoot, #vgzjjfmrhz tr, #vgzjjfmrhz td, #vgzjjfmrhz th {
  border-style: none;
}

#vgzjjfmrhz p {
  margin: 0;
  padding: 0;
}

#vgzjjfmrhz .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#vgzjjfmrhz .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#vgzjjfmrhz .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#vgzjjfmrhz .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#vgzjjfmrhz .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vgzjjfmrhz .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vgzjjfmrhz .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vgzjjfmrhz .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#vgzjjfmrhz .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#vgzjjfmrhz .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#vgzjjfmrhz .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#vgzjjfmrhz .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#vgzjjfmrhz .gt_spanner_row {
  border-bottom-style: hidden;
}

#vgzjjfmrhz .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#vgzjjfmrhz .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#vgzjjfmrhz .gt_from_md > :first-child {
  margin-top: 0;
}

#vgzjjfmrhz .gt_from_md > :last-child {
  margin-bottom: 0;
}

#vgzjjfmrhz .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#vgzjjfmrhz .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#vgzjjfmrhz .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#vgzjjfmrhz .gt_row_group_first td {
  border-top-width: 2px;
}

#vgzjjfmrhz .gt_row_group_first th {
  border-top-width: 2px;
}

#vgzjjfmrhz .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vgzjjfmrhz .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#vgzjjfmrhz .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#vgzjjfmrhz .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vgzjjfmrhz .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vgzjjfmrhz .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#vgzjjfmrhz .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#vgzjjfmrhz .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#vgzjjfmrhz .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vgzjjfmrhz .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vgzjjfmrhz .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vgzjjfmrhz .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vgzjjfmrhz .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vgzjjfmrhz .gt_left {
  text-align: left;
}

#vgzjjfmrhz .gt_center {
  text-align: center;
}

#vgzjjfmrhz .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#vgzjjfmrhz .gt_font_normal {
  font-weight: normal;
}

#vgzjjfmrhz .gt_font_bold {
  font-weight: bold;
}

#vgzjjfmrhz .gt_font_italic {
  font-style: italic;
}

#vgzjjfmrhz .gt_super {
  font-size: 65%;
}

#vgzjjfmrhz .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#vgzjjfmrhz .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#vgzjjfmrhz .gt_indent_1 {
  text-indent: 5px;
}

#vgzjjfmrhz .gt_indent_2 {
  text-indent: 10px;
}

#vgzjjfmrhz .gt_indent_3 {
  text-indent: 15px;
}

#vgzjjfmrhz .gt_indent_4 {
  text-indent: 20px;
}

#vgzjjfmrhz .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="vote_estimate">vote_estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="track">track</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="artist">artist</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="rank">rank</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="vote_estimate" class="gt_row gt_right">18.29412</td>
<td headers="track" class="gt_row gt_left">You Spin Me Round (Like a Record)</td>
<td headers="artist" class="gt_row gt_left">Dead Or Alive</td>
<td headers="rank" class="gt_row gt_right">40</td></tr>
    <tr><td headers="vote_estimate" class="gt_row gt_right">18.28493</td>
<td headers="track" class="gt_row gt_left">Bad Romance</td>
<td headers="artist" class="gt_row gt_left">Lady Gaga</td>
<td headers="rank" class="gt_row gt_right">41</td></tr>
    <tr><td headers="vote_estimate" class="gt_row gt_right">18.22394</td>
<td headers="track" class="gt_row gt_left">Dog Days Are Over</td>
<td headers="artist" class="gt_row gt_left">Florence + The Machine</td>
<td headers="rank" class="gt_row gt_right">42</td></tr>
    <tr><td headers="vote_estimate" class="gt_row gt_right">18.19308</td>
<td headers="track" class="gt_row gt_left">Rockstar</td>
<td headers="artist" class="gt_row gt_left">Nickelback</td>
<td headers="rank" class="gt_row gt_right">43</td></tr>
    <tr><td headers="vote_estimate" class="gt_row gt_right">18.11609</td>
<td headers="track" class="gt_row gt_left">Something So Strong</td>
<td headers="artist" class="gt_row gt_left">Crowded House</td>
<td headers="rank" class="gt_row gt_right">44</td></tr>
    <tr><td headers="vote_estimate" class="gt_row gt_right">17.82452</td>
<td headers="track" class="gt_row gt_left">Heads Will Roll - A-Trak Remix Radio Edit</td>
<td headers="artist" class="gt_row gt_left">Yeah Yeah Yeahs, A-Trak</td>
<td headers="rank" class="gt_row gt_right">45</td></tr>
    <tr><td headers="vote_estimate" class="gt_row gt_right">17.73934</td>
<td headers="track" class="gt_row gt_left">Silver Springs - 2004 Remaster</td>
<td headers="artist" class="gt_row gt_left">Fleetwood Mac</td>
<td headers="rank" class="gt_row gt_right">46</td></tr>
    <tr><td headers="vote_estimate" class="gt_row gt_right">17.68636</td>
<td headers="track" class="gt_row gt_left">Maneater</td>
<td headers="artist" class="gt_row gt_left">Nelly Furtado</td>
<td headers="rank" class="gt_row gt_right">47</td></tr>
    <tr><td headers="vote_estimate" class="gt_row gt_right">17.68585</td>
<td headers="track" class="gt_row gt_left">Tell Me Why - Radio Edit</td>
<td headers="artist" class="gt_row gt_left">Supermode, Axwell, Steve Angello</td>
<td headers="rank" class="gt_row gt_right">48</td></tr>
    <tr><td headers="vote_estimate" class="gt_row gt_right">17.64290</td>
<td headers="track" class="gt_row gt_left">Teenage Kicks</td>
<td headers="artist" class="gt_row gt_left">The Undertones</td>
<td headers="rank" class="gt_row gt_right">49</td></tr>
    <tr><td headers="vote_estimate" class="gt_row gt_right">17.55941</td>
<td headers="track" class="gt_row gt_left">Be My Baby</td>
<td headers="artist" class="gt_row gt_left">The Ronettes</td>
<td headers="rank" class="gt_row gt_right">50</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>